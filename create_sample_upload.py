"""р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М Excel р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕кр╕│р╕лр╕гр╕▒р╕Ъ Upload"""
import pandas as pd
from datetime import datetime

# р╕кр╕гр╣Йр╕▓р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З
data = {
    'Booking No': ['BK001', 'BK002', 'BK003', 'BK004', 'BK005', 'BK006', 'BK007', 'BK008'],
    'Branch Code': ['S001', 'S002', 'S003', 'S001', 'S004', 'S005', 'S002', 'S006'],
    'Branch Name': [
        'MAX MART-р╣Ар╕Кр╕╡р╕вр╕Зр╣Гр╕лр╕бр╣И р╕лр╕▓р╕Зр╕Фр╕З',
        'PUNTHAI-р╕Бр╕гр╕╕р╕Зр╣Ар╕Чр╕Ю р╕Ър╕▓р╕Зр╕Бр╕░р╕Ыр╕┤',
        'MAX MART-р╕Щр╕Др╕гр╕гр╕▓р╕Кр╕кр╕╡р╕бр╕▓ р╣Ар╕бр╕╖р╕нр╕З',
        'MAX MART-р╣Ар╕Кр╕╡р╕вр╕Зр╣Гр╕лр╕бр╣И р╕лр╕▓р╕Зр╕Фр╕З',
        'PUNTHAI-р╕Вр╕нр╕Щр╣Бр╕Бр╣Ир╕Щ р╣Ар╕бр╕╖р╕нр╕З',
        'MAX MART-р╕ар╕╣р╣Ар╕Бр╣Зр╕Х р╣Ар╕бр╕╖р╕нр╕З',
        'PUNTHAI-р╕Бр╕гр╕╕р╕Зр╣Ар╕Чр╕Ю р╕Ър╕▓р╕Зр╕Бр╕░р╕Ыр╕┤',
        'MAX MART-р╕кр╕Зр╕Вр╕ер╕▓ р╕лр╕▓р╕Фр╣Гр╕лр╕Нр╣И'
    ],
    'Total Wgt': [850.5, 1200.0, 650.3, 450.2, 980.0, 1500.5, 800.0, 720.0],
    'Total Cube': [8.5, 12.0, 6.5, 4.5, 9.8, 15.0, 8.0, 7.2],
    'Province': ['р╣Ар╕Кр╕╡р╕вр╕Зр╣Гр╕лр╕бр╣И', 'р╕Бр╕гр╕╕р╕Зр╣Ар╕Чр╕Юр╕бр╕лр╕▓р╕Щр╕Др╕г', 'р╕Щр╕Др╕гр╕гр╕▓р╕Кр╕кр╕╡р╕бр╕▓', 'р╣Ар╕Кр╕╡р╕вр╕Зр╣Гр╕лр╕бр╣И', 'р╕Вр╕нр╕Щр╣Бр╕Бр╣Ир╕Щ', 'р╕ар╕╣р╣Ар╕Бр╣Зр╕Х', 'р╕Бр╕гр╕╕р╕Зр╣Ар╕Чр╕Юр╕бр╕лр╕▓р╕Щр╕Др╕г', 'р╕кр╕Зр╕Вр╕ер╕▓']
}

df = pd.DataFrame(data)

# р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Ар╕Ыр╣Зр╕Щр╣Др╕Яр╕ер╣М Excel
filename = f'р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╣Др╕Яр╕ер╣М_Upload_{datetime.now().strftime("%Y%m%d")}.xlsx'
df.to_excel(filename, index=False, sheet_name='2.Punthai')

print("тЬЕ р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣Мр╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕кр╕│р╣Ар╕гр╣Зр╕И!")
print(f"ЁЯУД р╕Кр╕╖р╣Ир╕нр╣Др╕Яр╕ер╣М: {filename}")
print(f"ЁЯУК р╕Ир╕│р╕Щр╕зр╕Щр╕гр╕▓р╕вр╕Бр╕▓р╕г: {len(df)} р╕гр╕▓р╕вр╕Бр╕▓р╕г")
print(f"ЁЯУН р╕Ир╕│р╕Щр╕зр╕Щр╕кр╕▓р╕Вр╕▓: {df['Branch Code'].nunique()} р╕кр╕▓р╕Вр╕▓")
print(f"тЪЦя╕П р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕гр╕зр╕б: {df['Total Wgt'].sum():.1f} kg")
print(f"ЁЯУж р╕Др╕┤р╕зр╕гр╕зр╕б: {df['Total Cube'].sum():.1f} m┬│")
print("\nЁЯУЛ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕Щр╣Др╕Яр╕ер╣М:")
print(df.to_string(index=False))
print("\nЁЯТб р╣Гр╕Кр╣Йр╣Др╕Яр╕ер╣Мр╕Щр╕╡р╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ъ Upload р╣Гр╕Щр╣Ар╕зр╣Зр╕Ър╣Др╕Фр╣Йр╣Ар╕ер╕в!")
