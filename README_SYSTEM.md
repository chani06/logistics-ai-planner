# ЁЯУЛ р╕кр╕гр╕╕р╕Ыр╕гр╕░р╕Ър╕Ър╕Ир╕▒р╕Фр╣Ар╕Чр╕╡р╣Ир╕вр╕з - р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

## ЁЯОп р╕ар╕▓р╕Юр╕гр╕зр╕бр╕гр╕░р╕Ър╕Ъ

р╕гр╕░р╕Ър╕Ър╕Щр╕╡р╣Йр╣Гр╕Кр╣Й **Google OR-Tools** р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╣Ар╕Чр╕╡р╣Ир╕вр╕зр╕кр╣Ир╕Зр╕кр╕┤р╕Щр╕Др╣Йр╕▓ р╣Вр╕Фр╕вр╕бр╕╡р╕Бр╕▓р╕г Auto Sync р╕Вр╣Йр╕нр╕бр╕╣р╕е Master р╕кр╕▓р╕Вр╕▓р╕Ир╕▓р╕Б **Google Sheets** р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤

---

## ЁЯУК 1. р╕Вр╣Йр╕нр╕бр╕╣р╕е Master (р╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╣Йр╕▓р╕Зр╕нр╕┤р╕З)

### ЁЯФД р╣Бр╕лр╕ер╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е
- **Google Sheets**: "Master р╣Бр╕Ьр╕Щр╕Зр╕▓р╕Щ DC р╕зр╕▒р╕Зр╕Щр╣Йр╕нр╕в" тЖТ Worksheet "Master р╕кр╕▓р╕Вр╕▓"
- **Auto Sync**: р╕Чр╕╕р╕Бр╕Др╕гр╕▒р╣Йр╕Зр╕Чр╕╡р╣Ир╣Вр╕лр╕ер╕Фр╣Ар╕зр╣Зр╕Ъ
- **р╕Ир╕│р╕Щр╕зр╕Щ**: 8,147 р╕кр╕▓р╕Вр╕▓ (р╕гр╕зр╕б DC р╕зр╕▒р╕Зр╕Щр╣Йр╕нр╕в)

### ЁЯТ╛ р╣Др╕Яр╕ер╣М JSON (branch_data.json)
```json
{
  "S001": {
    "Plan Code": "S001",
    "р╕кр╕▓р╕Вр╕▓": "р╕кр╕▓р╕Вр╕▓ р╣Ар╕Кр╕╡р╕вр╕Зр╣Гр╕лр╕бр╣И р╕лр╕▓р╕Зр╕Фр╕З",
    "р╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф": "р╣Ар╕Кр╕╡р╕вр╕Зр╣Гр╕лр╕бр╣И",
    "р╕нр╕│р╣Ар╕ар╕н": "р╕лр╕▓р╕Зр╕Фр╕З",
    "р╕Хр╕│р╕Ър╕е": "р╕лр╕▓р╕Зр╕Фр╕З",
    "р╕ер╕░": 18.7456,
    "р╕ер╕нр╕З": 98.9234,
    "MaxTruckType": "6W"
  }
}
```

### ЁЯПв DC р╕зр╕▒р╕Зр╕Щр╣Йр╕нр╕в
- **р╕гр╕лр╕▒р╕к**: 8nvDC011
- **р╕Кр╕╖р╣Ир╕н**: DC р╕зр╕▒р╕Зр╕Щр╣Йр╕нр╕в
- **р╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣И**: PROJECT-р╕Ъ.р╕Юр╕╡р╕Чр╕╡р╕Ир╕╡ р╣Ар╕нр╣Зр╕Щр╣Ар╕Щр╕нр╕вр╕╡ р╕Ир╕│р╕Бр╕▒р╕Ф (р╕бр╕лр╕▓р╕Кр╕Щ) (DCр╕зр╕▒р╕Зр╕Щр╣Йр╕нр╕в)
- **р╕Хр╕│р╕Ър╕е**: р╕Юр╕вр╕нр╕б
- **р╕нр╕│р╣Ар╕ар╕н**: р╕зр╕▒р╕Зр╕Щр╣Йр╕нр╕в
- **р╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф**: р╕Юр╕гр╕░р╕Щр╕Др╕гр╕ир╕гр╕╡р╕нр╕вр╕╕р╕Шр╕вр╕▓
- **р╕Юр╕┤р╕Бр╕▒р╕Ф**: Lat 14.1793943, Lon 100.6481489

### ЁЯУН р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╣Ар╕Бр╣Зр╕Ъ
- Plan Code / р╕гр╕лр╕▒р╕кр╕кр╕▓р╕Вр╕▓
- р╕Кр╕╖р╣Ир╕нр╕кр╕▓р╕Вр╕▓ (р╣Др╕Чр╕в/р╕нр╕▒р╕Зр╕Бр╕др╕й)
- р╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣И (р╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф, р╕нр╕│р╣Ар╕ар╕н, р╕Хр╕│р╕Ър╕е)
- р╕Юр╕┤р╕Бр╕▒р╕Ф (Latitude, Longitude)
- р╕Вр╣Йр╕нр╕Ир╕│р╕Бр╕▒р╕Фр╕гр╕Ц (MaxTruckType: 4W, JB, 6W)
- р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б/р╕Др╕┤р╕з (р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕Фр╕кр╕нр╕Ъ)

---

## ЁЯУд 2. р╕Бр╕▓р╕гр╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╣Др╕Яр╕ер╣Мр╕кр╕│р╕лр╕гр╕▒р╕Ър╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣М

### ЁЯУД р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╣Др╕Яр╕ер╣М
- **р╕гр╕нр╕Зр╕гр╕▒р╕Ъ**: Excel (.xlsx)
- **Sheet**: р╕гр╕░р╕Ър╕Ър╕Ир╕░р╕Др╣Йр╕Щр╕лр╕▓ Sheet р╕Чр╕╡р╣Ир╕бр╕╡р╕Др╕│р╕зр╣Ир╕▓ "Punthai" р╕лр╕гр╕╖р╕н "2." р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
- **Header**: р╕гр╕░р╕Ър╕Ър╕лр╕▓ Header row р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤ (р╕Др╣Йр╕Щр╕лр╕▓р╕Др╕│р╕зр╣Ир╕▓ BRANCH, TRIP, р╕гр╕лр╕▒р╕кр╕кр╕▓р╕Вр╕▓)

### ЁЯУЭ р╕Др╕нр╕ер╕▒р╕бр╕Щр╣Мр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕бр╕╡ (Required)
| р╕Др╕нр╕ер╕▒р╕бр╕Щр╣М | р╕Кр╕╖р╣Ир╕нр╕Чр╕╡р╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ъ | р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З |
|---------|---------------|----------|
| **р╕гр╕лр╕▒р╕кр╕кр╕▓р╕Вр╕▓** | Plan Code / Branch Code / Code / р╕гр╕лр╕▒р╕кр╕кр╕▓р╕Вр╕▓ | S001, BR123 |
| **р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б** | Weight / Total Wgt / р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б | 850.5 kg |
| **р╕Др╕┤р╕з/р╕Ыр╕гр╕┤р╕бр╕▓р╕Хр╕г** | Cube / Total Cube / Volume / р╕Др╕┤р╕з | 8.5 m┬│ |

### ЁЯУЭ р╕Др╕нр╕ер╕▒р╕бр╕Щр╣Мр╣Ар╕кр╕гр╕┤р╕б (Optional)
| р╕Др╕нр╕ер╕▒р╕бр╕Щр╣М | р╕Кр╕╖р╣Ир╕нр╕Чр╕╡р╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ъ | р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕ |
|---------|---------------|----------|
| **р╕Кр╕╖р╣Ир╕нр╕кр╕▓р╕Вр╕▓** | Branch Name / р╕кр╕▓р╕Вр╕▓ | р╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Ар╕Хр╕┤р╕бр╕Ир╕▓р╕Б Master р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡ |
| **р╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф** | Province / р╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф | р╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Ар╕Хр╕┤р╕бр╕Ир╕▓р╕Б Master р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡ |
| **р╕нр╕│р╣Ар╕ар╕н** | District / р╕нр╕│р╣Ар╕ар╕н | р╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Ар╕Хр╕┤р╕бр╕Ир╕▓р╕Б Master р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡ |
| **Booking No** | Booking No / р╣Ар╕ер╕Вр╕Чр╕╡р╣Ир╣Гр╕Ър╕Ир╕нр╕З | р╕кр╕│р╕лр╕гр╕▒р╕Ър╕нр╣Йр╕▓р╕Зр╕нр╕┤р╕З |

### ЁЯУЛ р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╣Др╕Яр╕ер╣М Upload
```
Booking No | Branch Code | Branch Name          | Total Wgt | Total Cube | Province
-----------|-------------|----------------------|-----------|------------|----------
BK001      | S001        | р╣Ар╕Кр╕╡р╕вр╕Зр╣Гр╕лр╕бр╣И р╕лр╕▓р╕Зр╕Фр╕З      | 850.5     | 8.5        | р╣Ар╕Кр╕╡р╕вр╕Зр╣Гр╕лр╕бр╣И
BK002      | S002        | р╕Бр╕гр╕╕р╕Зр╣Ар╕Чр╕Ю р╕Ър╕▓р╕Зр╕Бр╕░р╕Ыр╕┤      | 1200.0    | 12.0       | р╕Бр╕гр╕╕р╕Зр╣Ар╕Чр╕Юр╕п
BK003      | S003        | р╕Щр╕Др╕гр╕гр╕▓р╕Кр╕кр╕╡р╕бр╕▓ р╣Ар╕бр╕╖р╕нр╕З     | 650.3     | 6.5        | р╕Щр╕Др╕гр╕гр╕▓р╕Кр╕кр╕╡р╕бр╕▓
```

### ЁЯФН р╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤
1. **Auto-detect Sheet**: р╕лр╕▓ Sheet р╕Чр╕╡р╣Ир╕бр╕╡ "Punthai" р╕лр╕гр╕╖р╕н "2."
2. **Auto-detect Header**: р╕лр╕▓ row р╕Чр╕╡р╣Ир╕бр╕╡ BRANCH, TRIP, р╕гр╕лр╕▒р╕кр╕кр╕▓р╕Вр╕▓
3. **Column Mapping**: р╣Бр╕Ыр╕ер╕Зр╕Кр╕╖р╣Ир╕нр╕Др╕нр╕ер╕▒р╕бр╕Щр╣Мр╣Ар╕Ыр╣Зр╕Щр╕бр╕▓р╕Хр╕гр╕Рр╕▓р╕Щ
4. **Data Enrichment**: р╣Ар╕Хр╕┤р╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б Master (р╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф, р╕нр╕│р╣Ар╕ар╕н, р╕Юр╕┤р╕Бр╕▒р╕Ф)
5. **Validation**: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ
6. **Show Summary**: р╣Бр╕кр╕Фр╕Зр╕кр╕гр╕╕р╕Ы (р╕Ир╕│р╕Щр╕зр╕Щр╕кр╕▓р╕Вр╕▓, р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б, р╕Др╕┤р╕з, р╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф)

---

## ЁЯУе 3. р╕Бр╕▓р╕г Export р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М

### ЁЯУж р╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣И 1: р╕Ьр╕ер╕Ир╕▒р╕Фр╕Чр╕гр╕┤р╕Ы (р╕Ир╕▓р╕Бр╣Бр╕Чр╣Зр╕Ъ "р╕Ир╕▒р╕Фр╣Ар╕Чр╕╡р╣Ир╕вр╕з")
- **р╕Кр╕╖р╣Ир╕нр╣Др╕Яр╕ер╣М**: `р╕Ьр╕ер╕Ир╕▒р╕Фр╕Чр╕гр╕┤р╕Ы_YYYYMMDD_HHMMSS.xlsx`
- **Sheet 1: р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Чр╕гр╕┤р╕Ы**
  - Trip (р╣Ар╕ер╕Вр╕Чр╕гр╕┤р╕Ы)
  - Trip_No (р╕гр╕лр╕▒р╕кр╕Чр╕гр╕┤р╕Ы р╣Ар╕Кр╣Ир╕Щ T001)
  - Code (р╕гр╕лр╕▒р╕кр╕кр╕▓р╕Вр╕▓)
  - Name (р╕Кр╕╖р╣Ир╕нр╕кр╕▓р╕Вр╕▓)
  - Weight (р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б)
  - Cube (р╕Др╕┤р╕з)
  - Province (р╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф)
  - District (р╕нр╕│р╣Ар╕ар╕н)
  - Vehicle (р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕гр╕Ц: 4W, JB, 6W)
- **Sheet 2: р╕кр╕гр╕╕р╕Ыр╕Чр╕гр╕┤р╕Ы**
  - Trip_No (р╕гр╕лр╕▒р╕кр╕Чр╕гр╕┤р╕Ы)
  - Vehicle (р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕гр╕Ц)
  - Branches (р╕Ир╕│р╕Щр╕зр╕Щр╕кр╕▓р╕Вр╕▓)
  - Weight (р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕гр╕зр╕б)
  - Cube (р╕Др╕┤р╕зр╕гр╕зр╕б)
  - Province (р╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Фр╕лр╕ер╕▒р╕Б)

### ЁЯЧ║я╕П р╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣И 2: р╕Ир╕▒р╕Фр╕Бр╕ер╕╕р╣Ир╕бр╕кр╕▓р╕Вр╕▓ (р╕Ир╕▓р╕Бр╣Бр╕Чр╣Зр╕Ъ "р╕Ир╕▒р╕Фр╕Бр╕ер╕╕р╣Ир╕бр╕Хр╕▓р╕бр╕ар╕▓р╕Д")
- **р╕Кр╕╖р╣Ир╕нр╣Др╕Яр╕ер╣М**: `р╕Ир╕▒р╕Фр╕Бр╕ер╕╕р╣Ир╕бр╕кр╕▓р╕Вр╕▓_YYYYMMDD_HHMMSS.xlsx`
- **Sheet 1: р╕кр╕▓р╕Вр╕▓р╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф**
  - Code (р╕гр╕лр╕▒р╕кр╕кр╕▓р╕Вр╕▓)
  - Name (р╕Кр╕╖р╣Ир╕нр╕кр╕▓р╕Вр╕▓)
  - Province (р╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф)
  - District (р╕нр╕│р╣Ар╕ар╕н)
  - Region (р╕ар╕▓р╕Д: NORTH, NORTHEAST, CENTRAL, EAST, SOUTH)
  - Weight (р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б)
  - Cube (р╕Др╕┤р╕з)
- **Sheet 2: р╕кр╕гр╕╕р╕Ыр╕Хр╕▓р╕бр╕ар╕▓р╕Д**
  - Region (р╕ар╕▓р╕Д)
  - Branches (р╕Ир╕│р╕Щр╕зр╕Щр╕кр╕▓р╕Вр╕▓)
  - Weight (р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕гр╕зр╕б)
  - Cube (р╕Др╕┤р╕зр╕гр╕зр╕б)

---

## ЁЯФД 4. р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ JSON File

### тЭУ JSON р╕Др╕╖р╕нр╕нр╕░р╣Др╕г?
- **branch_data.json** р╣Ар╕Ыр╣Зр╕Щ**р╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╣Йр╕▓р╕Зр╕нр╕┤р╕З** (Master Data)
- **р╣Др╕бр╣Ир╣Гр╕Кр╣И**р╣Др╕Яр╕ер╣Мр╕кр╕│р╕лр╕гр╕▒р╕Ър╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╣Вр╕Фр╕вр╕Хр╕гр╕З
- Sync р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤р╕Ир╕▓р╕Б Google Sheets

### тЬЕ р╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ъ
1. **р╣Ар╕Хр╕┤р╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣И** - р╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф, р╕нр╕│р╣Ар╕ар╕н, р╕Хр╕│р╕Ър╕е
2. **р╣Ар╕Хр╕┤р╕бр╕Юр╕┤р╕Бр╕▒р╕Ф** - Latitude, Longitude
3. **р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕Ир╕│р╕Бр╕▒р╕Фр╕гр╕Ц** - MaxTruckType (4W, JB, 6W)
4. **р╕Др╣Йр╕Щр╕лр╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕▓р╕Вр╕▓** - р╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕бр╕╡р╣Гр╕Щр╣Др╕Яр╕ер╣М Upload

### тЭМ р╣Др╕бр╣Ир╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ъ
- Upload р╣Вр╕Фр╕вр╕Хр╕гр╕З (р╣Гр╕Кр╣Йр╣Др╕Яр╕ер╣М Excel р╣Бр╕Чр╕Щ)
- р╣Бр╕Бр╣Йр╣Др╕Вр╕Вр╣Йр╕нр╕бр╕╣р╕е (р╣Бр╕Бр╣Йр╕Чр╕╡р╣И Google Sheets р╣Бр╕ер╣Йр╕з Sync)

---

## ЁЯЪА 5. р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 1: р╣Ар╕Ыр╕┤р╕Фр╣Ар╕зр╣Зр╕Ъ
```bash
streamlit run app.py
```
- р╕гр╕░р╕Ър╕Ър╕Ир╕░ **Auto Sync Master** р╕Ир╕▓р╕Б Google Sheets
- р╣Бр╕кр╕Фр╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б "тЬЕ р╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е Master р╕кр╕│р╣Ар╕гр╣Зр╕И: 8,147 р╕кр╕▓р╕Вр╕▓"

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 2: Upload р╣Др╕Яр╕ер╣М Excel
- р╕Др╕ер╕┤р╕Б **"р╣Ар╕ер╕╖р╕нр╕Бр╣Др╕Яр╕ер╣М Excel (.xlsx)"**
- р╣Ар╕ер╕╖р╕нр╕Бр╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╕бр╕╡р╕гр╕▓р╕вр╕Бр╕▓р╕гр╕нр╕нр╣Ар╕Фр╕нр╕гр╣М/р╕кр╕▓р╕Вр╕▓
- р╕гр╕нр╕гр╕░р╕Ър╕Ър╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕е

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 3: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕е
р╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Бр╕кр╕Фр╕З:
- ЁЯУН р╕Ир╕│р╕Щр╕зр╕Щр╕кр╕▓р╕Вр╕▓
- тЪЦя╕П р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕гр╕зр╕б
- ЁЯУж р╕Др╕┤р╕зр╕гр╕зр╕б
- ЁЯЧ║я╕П р╕Ир╕│р╕Щр╕зр╕Щр╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф
- ЁЯФН р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕е (10 р╕гр╕▓р╕вр╕Бр╕▓р╕гр╣Бр╕гр╕Б)

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 4: р╣Ар╕ер╕╖р╕нр╕Бр╣Бр╕Чр╣Зр╕Ъ
#### ЁЯЪЫ р╣Бр╕Чр╣Зр╕Ър╕Чр╕╡р╣И 1: р╕Ир╕▒р╕Фр╣Ар╕Чр╕╡р╣Ир╕вр╕з (р╕Хр╕▓р╕бр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б)
- р╣Гр╕Кр╣Й **Google OR-Tools** CP-SAT Solver
- р╕Ир╕▒р╕Фр╕Чр╕гр╕┤р╕Ыр╕Хр╕▓р╕бр╕Вр╣Йр╕нр╕Ир╕│р╕Бр╕▒р╕Ф:
  - р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕гр╕Ц (4W: 1,200 kg, JB: 3,500 kg, 6W: 6,000 kg)
  - р╕Ыр╕гр╕┤р╕бр╕▓р╕Хр╕г (Cube)
  - р╕Ир╕│р╕Щр╕зр╕Щ Drop (р╕кр╕▓р╕Вр╕▓)
  - р╕Вр╣Йр╕нр╕Ир╕│р╕Бр╕▒р╕Фр╕гр╕Цр╣Бр╕Хр╣Ир╕ер╕░р╕кр╕▓р╕Вр╕▓
- р╣Ар╕Щр╣Йр╕Щр╕кр╕▓р╕Вр╕▓р╕Чр╕╡р╣Ир╕бр╕╡р╕Вр╣Йр╕нр╕Ир╕│р╕Бр╕▒р╕Фр╕Бр╣Ир╕нр╕Щ: **4W тЖТ JB тЖТ 6W**
- р╣Ар╕зр╕ер╕▓р╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕е: **< 60 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡**

#### ЁЯЧ║я╕П р╣Бр╕Чр╣Зр╕Ър╕Чр╕╡р╣И 2: р╕Ир╕▒р╕Фр╕Бр╕ер╕╕р╣Ир╕бр╕Хр╕▓р╕бр╕ар╕▓р╕Д
- р╕Ир╕▒р╕Фр╕Бр╕ер╕╕р╣Ир╕бр╕кр╕▓р╕Вр╕▓р╕Хр╕▓р╕бр╕ар╕╣р╕бр╕┤р╕ар╕▓р╕Д (NORTH, NORTHEAST, CENTRAL, EAST, SOUTH)
- р╣Др╕бр╣Ир╕Др╕│р╕Щр╕╢р╕Зр╕Цр╕╢р╕Зр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Б
- р╣Бр╕кр╕Фр╕Зр╕кр╕гр╕╕р╕Ыр╕Хр╕▓р╕бр╕ар╕▓р╕Д

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 5: р╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕е
- р╕Др╕ер╕┤р╕Б **"р╣Ар╕гр╕┤р╣Ир╕бр╕Ир╕▒р╕Фр╣Ар╕Чр╕╡р╣Ир╕вр╕з"** (р╣Бр╕Чр╣Зр╕Ър╕Чр╕╡р╣И 1) р╕лр╕гр╕╖р╕н **"р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣М"** (р╣Бр╕Чр╣Зр╕Ър╕Чр╕╡р╣И 2)
- р╕гр╕нр╕гр╕░р╕Ър╕Ър╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕е
- р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М

### р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 6: Download р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М
- р╕Др╕ер╕┤р╕Б **"ЁЯУе р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М (Excel)"**
- р╣Др╕Яр╕ер╣Мр╕Ир╕░р╕Цр╕╣р╕Бр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Ар╕Ыр╣Зр╕Щ `.xlsx`

---

## тЪЩя╕П 6. р╕Бр╕▓р╕гр╕Ир╕▒р╕Фр╕Бр╕▓р╕г Master Data

### ЁЯУК р╕Фр╕╣р╕Вр╣Йр╕нр╕бр╕╣р╕е Master р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ
1. р╣Ар╕Ыр╕┤р╕Ф **Sidebar** (р╕Фр╣Йр╕▓р╕Щр╕Лр╣Йр╕▓р╕в)
2. р╕Др╕ер╕┤р╕Б **"ЁЯУК р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╕Вр╣Йр╕нр╕бр╕╣р╕е Master"**
3. р╣Ар╕ер╕╖р╕нр╕Б **"ЁЯСБя╕П р╕Фр╕╣р╕Вр╣Йр╕нр╕бр╕╣р╕е Master р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ"**

### тмЖя╕П р╕нр╕▒р╕Ыр╣Ар╕Фр╕Х Master Data
1. р╣Ар╕Хр╕гр╕╡р╕вр╕бр╣Др╕Яр╕ер╣М Excel р╕Чр╕╡р╣Ир╕бр╕╡р╕Др╕нр╕ер╕▒р╕бр╕Щр╣М:
   - Plan Code (р╕гр╕лр╕▒р╕кр╕кр╕▓р╕Вр╕▓)
   - р╕Ир╕▒р╕Зр╕лр╕зр╕▒р╕Ф
   - р╕нр╕│р╣Ар╕ар╕н
   - р╕Хр╕│р╕Ър╕е
   - Lat / р╕ер╕░р╕Хр╕┤р╕Ир╕╣р╕Ф
   - Lon / р╕ер╕нр╕Зр╕Хр╕┤р╕Ир╕╣р╕Ф
2. Upload р╣Др╕Яр╕ер╣Мр╕Ьр╣Ир╕▓р╕Щ Sidebar
3. р╕Др╕ер╕┤р╕Б **"тмЖя╕П р╕нр╕▒р╕Ыр╣Ар╕Фр╕Х Master Data"**
4. Refresh р╕лр╕Щр╣Йр╕▓р╣Ар╕зр╣Зр╕Ъ

---

## ЁЯФз 7. р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕▓р╕Зр╣Ар╕Чр╕Др╕Щр╕┤р╕Д

### ЁЯзо OR-Tools Configuration
- **Solver**: CP-SAT (Constraint Programming)
- **Time Limit**: 50 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡
- **Max Trips per Vehicle**: 80 р╕Чр╕гр╕┤р╕Ы
- **Workers**: 8 threads (parallel processing)
- **Log Level**: р╕Ыр╕┤р╕Ф (р╣Ар╕Юр╕╖р╣Ир╕нр╕Др╕зр╕▓р╕бр╣Ар╕гр╣Зр╕з)

### ЁЯЪЫ р╕Вр╣Йр╕нр╕Ир╕│р╕Бр╕▒р╕Фр╕гр╕Ц (Vehicle Constraints)
| р╕гр╕Ц | р╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕кр╕╣р╕Зр╕кр╕╕р╕Ф | р╕Др╕┤р╕зр╕кр╕╣р╕Зр╕кр╕╕р╕Ф | Drop р╕кр╕╣р╕Зр╕кр╕╕р╕Ф |
|----|--------------|----------|------------|
| 4W | 1,200 kg | 5.0 m┬│ | 8 р╕кр╕▓р╕Вр╕▓ |
| JB | 3,500 kg | 12.0 m┬│ | 10 р╕кр╕▓р╕Вр╕▓ |
| 6W | 6,000 kg | 20.0 m┬│ | 12 р╕кр╕▓р╕Вр╕▓ |

### ЁЯОп Priority System
1. **4W** (Priority 1) - р╕Вр╣Йр╕нр╕Ир╕│р╕Бр╕▒р╕Фр╕кр╕╣р╕Зр╕кр╕╕р╕Ф
2. **JB** (Priority 2) - р╕Вр╣Йр╕нр╕Ир╕│р╕Бр╕▒р╕Фр╕Ыр╕▓р╕Щр╕Бр╕ер╕▓р╕З
3. **6W** (Priority 3) - р╣Др╕бр╣Ир╕бр╕╡р╕Вр╣Йр╕нр╕Ир╕│р╕Бр╕▒р╕Ф

### ЁЯЧ║я╕П Region Mapping
- **NORTH**: р╣Ар╕Кр╕╡р╕вр╕Зр╣Гр╕лр╕бр╣И, р╣Ар╕Кр╕╡р╕вр╕Зр╕гр╕▓р╕в, р╕ер╕│р╕Ыр╕▓р╕З, р╕пр╕ер╕п
- **NORTHEAST**: р╕Вр╕нр╕Щр╣Бр╕Бр╣Ир╕Щ, р╕нр╕╕р╕Фр╕гр╕Шр╕▓р╕Щр╕╡, р╕Щр╕Др╕гр╕гр╕▓р╕Кр╕кр╕╡р╕бр╕▓, р╕пр╕ер╕п
- **CENTRAL**: р╕Бр╕гр╕╕р╕Зр╣Ар╕Чр╕Юр╕п, р╕Щр╕Щр╕Чр╕Ър╕╕р╕гр╕╡, р╕Ыр╕Чр╕╕р╕бр╕Шр╕▓р╕Щр╕╡, р╕пр╕ер╕п
- **EAST**: р╕Кр╕ер╕Ър╕╕р╕гр╕╡, р╕гр╕░р╕вр╕нр╕З, р╕Ир╕▒р╕Щр╕Чр╕Ър╕╕р╕гр╕╡, р╕пр╕ер╕п
- **SOUTH**: р╕кр╕╕р╕гр╕▓р╕йр╕Ор╕гр╣Мр╕Шр╕▓р╕Щр╕╡, р╕ар╕╣р╣Ар╕Бр╣Зр╕Х, р╕кр╕Зр╕Вр╕ер╕▓, р╕пр╕ер╕п

---

## тЬЕ 8. р╕кр╕гр╕╕р╕Ы

### ЁЯУК р╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕З
| р╣Др╕Яр╕ер╣М | р╕Ыр╕гр╕░р╣Ар╕ар╕Ч | р╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ъ |
|------|--------|-----------|
| `branch_data.json` | JSON | р╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╣Йр╕▓р╕Зр╕нр╕┤р╕З (Master) |
| `р╣Др╕Яр╕ер╣М Upload.xlsx` | Excel | р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣М (Orders/Bookings) |
| `р╕Ьр╕ер╕Ир╕▒р╕Фр╕Чр╕гр╕┤р╕Ы_*.xlsx` | Excel | р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Ир╕▒р╕Фр╣Ар╕Чр╕╡р╣Ир╕вр╕з |
| `р╕Ир╕▒р╕Фр╕Бр╕ер╕╕р╣Ир╕бр╕кр╕▓р╕Вр╕▓_*.xlsx` | Excel | р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Ир╕▒р╕Фр╕Бр╕ер╕╕р╣Ир╕бр╕ар╕▓р╕Д |

### ЁЯФД Flow р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щ
```
1. р╣Ар╕Ыр╕┤р╕Фр╣Ар╕зр╣Зр╕Ъ тЖТ Auto Sync Master р╕Ир╕▓р╕Б Google Sheets тЖТ branch_data.json
2. Upload Excel (Orders) тЖТ р╕гр╕░р╕Ър╕Ър╕нр╣Ир╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е тЖТ р╣Ар╕Хр╕┤р╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Б Master
3. р╣Бр╕кр╕Фр╕Зр╕кр╕гр╕╕р╕Ы тЖТ р╣Ар╕ер╕╖р╕нр╕Бр╣Бр╕Чр╣Зр╕Ъ тЖТ р╕Бр╕Фр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕е
4. р╣Гр╕Кр╣Й OR-Tools р╕Ир╕▒р╕Фр╕Чр╕гр╕┤р╕Ы тЖТ р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М
5. Download Excel р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М
```

### тЬЕ р╕Ир╕╕р╕Фр╣Ар╕Фр╣Ир╕Щ
- тЬЕ **Auto Sync** р╕Ир╕▓р╕Б Google Sheets
- тЬЕ **р╕гр╕зр╕б DC р╕зр╕▒р╕Зр╕Щр╣Йр╕нр╕в** р╣Гр╕Щр╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е
- тЬЕ **Auto-detect** р╕Др╕нр╕ер╕▒р╕бр╕Щр╣Мр╣Бр╕ер╕░ Header
- тЬЕ **р╣Ар╕Хр╕┤р╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤** р╕Ир╕▓р╕Б Master
- тЬЕ **OR-Tools** р╣Ар╕гр╣Зр╕з (< 60 р╕зр╕┤р╕Щр╕▓р╕Чр╕╡)
- тЬЕ **Priority System** (4W тЖТ JB тЖТ 6W)
- тЬЕ **Export Excel** р╕Юр╕гр╣Йр╕нр╕бр╕кр╕гр╕╕р╕Ы

---

**ЁЯЪА р╕Юр╕гр╣Йр╕нр╕бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ!** р╣Ар╕Ыр╕┤р╕Фр╣Ар╕зр╣Зр╕Ър╕Фр╣Йр╕зр╕в `streamlit run app.py`
