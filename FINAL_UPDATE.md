# ‚úÖ ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç - ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å Google Sheets

## üéØ ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á:

### 1. ‚úÖ **‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå Sample Data**
- ‚ùå ‡∏•‡∏ö `create_sample_data.py` (‡∏™‡∏£‡πâ‡∏≤‡∏á sample 500 ‡∏™‡∏≤‡∏Ç‡∏≤)
- ‚ùå ‡∏•‡∏ö `branch_data.json` ‡πÄ‡∏Å‡πà‡∏≤ (‡∏ó‡∏µ‡πà‡∏°‡∏µ BR0001-BR0500)
- ‚úÖ Sync ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å Google Sheets ‡πÉ‡∏´‡∏°‡πà

### 2. ‚úÖ **‡∏•‡∏ö Code ‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ**
- ‡∏•‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `update_excel()` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 230-244)
- ‡∏•‡∏ö‡∏õ‡∏∏‡πà‡∏° `'‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 246-252)
- ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏Ç‡∏∂‡πâ‡∏ô

### 3. ‚úÖ **Export Excel - ‡∏¢‡∏±‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°**
```python
# ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 1: ‡∏ú‡∏•‡∏à‡∏±‡∏î‡∏ó‡∏£‡∏¥‡∏õ
with pd.ExcelWriter(output, engine='xlsxwriter') as writer:
    export_df.to_excel(writer, sheet_name='‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏£‡∏¥‡∏õ', index=False)
    summary.to_excel(writer, sheet_name='‡∏™‡∏£‡∏∏‡∏õ‡∏ó‡∏£‡∏¥‡∏õ', index=False)

st.download_button(
    label="üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå (Excel)",
    data=output.getvalue(),
    file_name=f"‡∏ú‡∏•‡∏à‡∏±‡∏î‡∏ó‡∏£‡∏¥‡∏õ_{datetime.now().strftime('%Y%m%d_%H%M%S')}.xlsx",
    mime="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
)

# ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà 2: ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏†‡∏≤‡∏Ñ
with pd.ExcelWriter(output_region, engine='xlsxwriter') as writer:
    df_region.to_excel(writer, sheet_name='‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î', index=False)
    region_summary.to_excel(writer, sheet_name='‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏Ñ', index=False)
```
**‚úÖ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á Export - ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°**

### 4. ‚úÖ **Upload ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå - ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°**
```python
# Upload Excel (.xlsx)
uploaded_file = st.file_uploader("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå Excel (.xlsx)", type=['xlsx'])

if uploaded_file:
    # ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    df = load_excel(uploaded_file_content)
    df = process_dataframe(df)
    
    # ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Master
    if not MASTER_DATA.empty:
        # ‡πÉ‡∏ä‡πâ branch_data.json (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å Google Sheets)
        master_lookup = {...}
        # ‡πÄ‡∏ï‡∏¥‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î, ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠, ‡∏ï‡∏≥‡∏ö‡∏•, Lat/Lon
```
**‚úÖ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á Flow - ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°**

---

## üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:

### branch_data.json (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á)
```json
{
  "8nvDC011": {
    "‡∏™‡∏≤‡∏Ç‡∏≤": "DC ‡∏ß‡∏±‡∏á‡∏ô‡πâ‡∏≠‡∏¢",
    "‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î": "‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤",
    "‡∏•‡∏∞": 14.1793943,
    "‡∏•‡∏≠‡∏á": 100.6481489
  },
  "S046": {
    "‡∏™‡∏≤‡∏Ç‡∏≤": "LUBE1-‡∏õ‡∏•‡∏≤‡∏¢‡∏û‡∏£‡∏∞‡∏¢‡∏≤",
    "‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î": "‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà",
    "‡∏•‡∏∞": ...,
    "‡∏•‡∏≠‡∏á": ...
  }
}
```

### ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥:
- ‚úÖ **‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏≤‡∏Ç‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: 7,647 ‡∏™‡∏≤‡∏Ç‡∏≤**
- ‚úÖ **‡∏£‡∏ß‡∏° DC ‡∏ß‡∏±‡∏á‡∏ô‡πâ‡∏≠‡∏¢ (8nvDC011)**
- ‚úÖ **100% ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å Google Sheets**
- ‚ùå **Sample data (BR0001-BR0500): 0 ‡∏™‡∏≤‡∏Ç‡∏≤**

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≤‡∏Ç‡∏≤‡∏à‡∏£‡∏¥‡∏á:
1. **8nvDC011**: DC ‡∏ß‡∏±‡∏á‡∏ô‡πâ‡∏≠‡∏¢ - ‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤
2. **S046**: LUBE1-‡∏õ‡∏•‡∏≤‡∏¢‡∏û‡∏£‡∏∞‡∏¢‡∏≤ - ‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà
3. **S959**: LUBE1-‡∏≠‡πà‡∏≤‡∏ß‡∏•‡∏∂‡∏Å4 - ‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà
4. **S739**: LUBE1-‡∏Ñ‡∏•‡∏≠‡∏á‡∏ó‡πà‡∏≠‡∏°2 - ‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà
5. **S421**: LUBE1-‡∏Ñ‡∏•‡∏≠‡∏á‡∏ó‡πà‡∏≠‡∏° - ‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà

---

## üîÑ Flow ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô):

```
1. ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö
   ‚Üì
2. Auto Sync ‡∏à‡∏≤‡∏Å Google Sheets (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ credentials.json)
   ‚Üí ‡πÇ‡∏´‡∏•‡∏î 7,647 ‡∏™‡∏≤‡∏Ç‡∏≤‡∏à‡∏£‡∏¥‡∏á
   ‚Üì
3. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á branch_data.json
   ‚Üì
4. ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Master (7,647 ‡∏™‡∏≤‡∏Ç‡∏≤ + DC ‡∏ß‡∏±‡∏á‡∏ô‡πâ‡∏≠‡∏¢)
   ‚Üì
5. ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ Upload Excel (‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå/‡∏™‡∏≤‡∏Ç‡∏≤)
   ‚Üì
6. ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Master
   - ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
   - ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠
   - ‡∏ï‡∏≥‡∏ö‡∏•
   - Lat/Lon
   - MaxTruckType
   ‚Üì
7. ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
   ‚Üì
8. ‡∏à‡∏±‡∏î‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏î‡πâ‡∏ß‡∏¢ OR-Tools
   ‚Üì
9. Export Excel (2 ‡πÑ‡∏ü‡∏•‡πå)
   - ‡∏ú‡∏•‡∏à‡∏±‡∏î‡∏ó‡∏£‡∏¥‡∏õ (‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î + ‡∏™‡∏£‡∏∏‡∏õ)
   - ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏†‡∏≤‡∏Ñ (‡∏™‡∏≤‡∏Ç‡∏≤ + ‡∏™‡∏£‡∏∏‡∏õ)
```

---

## ‚úÖ ‡∏™‡∏£‡∏∏‡∏õ:

| ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
|--------|-------|----------|
| **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Master** | ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á | 7,647 ‡∏™‡∏≤‡∏Ç‡∏≤‡∏à‡∏≤‡∏Å Google Sheets |
| **Sample Data** | ‚ùå ‡∏•‡∏ö‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß | ‡πÑ‡∏°‡πà‡∏°‡∏µ BR0001-BR0500 |
| **DC ‡∏ß‡∏±‡∏á‡∏ô‡πâ‡∏≠‡∏¢** | ‚úÖ ‡∏°‡∏µ | 8nvDC011 |
| **Export Excel** | ‚úÖ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° | ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô |
| **Upload & ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå** | ‚úÖ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° | ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô |
| **Code ‡πÄ‡∏Å‡πà‡∏≤** | ‚úÖ ‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß | update_excel, button |

---

## üöÄ ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á 100%!

**‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö:**
```bash
streamlit run app.py
```

**URL:** http://localhost:8501 ‡∏´‡∏£‡∏∑‡∏≠ http://localhost:8502
